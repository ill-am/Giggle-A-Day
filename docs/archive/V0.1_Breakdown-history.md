# V0.1 Breakdown

This document outlines the remaining work required to complete the v0.1 milestone, with a detailed breakdown of the UI Polish and End-to-End Testing phase.

## Assessment and Remaining Work

- **Status**: The project is well on its way to completing the v0.1 goals. The foundational backend work and the core PDF generation pipeline are in place and tested. The CI/CD process has been significantly improved and documented.
- **Progress**: A substantial amount of work has been completed, and it is well-documented in `PATH_V0.1.md` and `CHAT_HISTORY.md`.
- **What Remains to Do**: Based on the current status, here are the key remaining tasks to complete v0.1:
  1.  **UI Polish and E2E Testing**: Stabilize flaky UI end-to-end tests and polish the UI with loading states and better error handling.
  2.  **PDF Quality Assertions**: Add tests to verify PDF quality (fonts, DPI, etc.).
  3.  **Documentation**: Write final user-facing documentation.
  4.  **Final QA**: Perform a final round of quality assurance.

---

## UI Polish and E2E Testing Breakdown

This phase focuses on shifting from "does it work?" to "is it reliable, robust, and pleasant to use?"

```markdown
# V0.1 — Progress Report and Prioritized Next Steps

Purpose: convert this file into a concise progress update that highlights what is Done vs Deferred and a short, prioritized next-steps list the team can act on immediately.

## Quick checklist (what you asked to track)

- [ ] Convert remaining `pdf-parse` usage to `pdfjs-dist` or the canonical extractor (tests should call the extractor subprocess rather than import `pdf-parse`).
- [ ] Add PDF quality assertions (fonts embedded, DPI heuristics, page count).
- [ ] Stabilize UI E2E (reliable selectors, retries, store-driven tests).
- [ ] Ensure CI uploads test artifacts for client failures and server export verification.
- [ ] Finish user-facing documentation and examples.

## Current status (summary)

- Foundation & export pipeline: Done — `server/ebook.js`, `/api/export/book`, Puppeteer export, and smoke scripts are implemented and locally verified.
- Extractor and tests: Partially done — `server/scripts/extract-pdf-text.js` prints `PAGE_COUNT` and server export tests call it as a subprocess; any remaining `pdf-parse` imports should be removed.
- PDF page-count assertions: Done — server export tests assert page count; font/DPI assertions are Deferred.
- UI tests & headless scripts: Partially done — `data-testid` attributes added, headless script updated with retries and DOM dumps, and store-driven tests added where needed.
- CI & artifacts: Partially done — `verify-export.yml` and artifact uploads exist for server artifacts; ensure client artifacts upload on failure (Deferred small change).
- Repository hygiene: Done — accidental `client/.next`, root `server-logs`, and root `test-artifacts` were removed from the index/history and package-local artifact/log folders are used.

## Requirements checklist (Done / Deferred)

- Convert `pdf-parse` → extractor/pdfjs-dist: Partially Done (scan required) ✅/⏳
- PDF page count assertions: Done ✅
- Font embedded assertions: Deferred ⏳
- DPI heuristic/assertion: Deferred ⏳
- Stable E2E tests (data-testid + retries): Partially Done ✅/⏳
- Store-driven deterministic UI tests: Done (representative tests added) ✅
- Client artifact upload on failure in CI: Deferred ⏳
- Per-package Vitest hermetic configs: Done ✅
- Move server logs to `server/logs` and ignore: Done ✅

## Prioritized next steps (actions you can take now)

1. High — Scan & replace leftover `pdf-parse` usage (15–30m)

- Why: removes flaky import side-effects and makes test runs deterministic.
- Action: grep for `pdf-parse` and replace imports with a subprocess call to `scripts/extract-pdf-text.js` or rewrite to `pdfjs-dist`. I can run this scan and open a small PR. (Recommended)

2. High — Add font and DPI checks to server export tests (60–90m)

- Why: raises confidence in PDF quality beyond page count.
- Action: add a small `pdfjs-dist` based assertion that at least one font is embedded and use pixel-size heuristics for DPI (I can implement a conservative check and tests).

3. High — Enable client artifact uploads on failure in CI (15–30m)

- Why: faster triage for flaky client tests.
- Action: add an `upload-artifact` step conditioned on job failure to the `client-tests` job in `verify-export.yml`.

4. Medium — Run full CI matrix and triage failures (30–60m)

- Why: validate cross-package tests in CI and capture artifacts.
- Action: open PR or trigger workflow on branch `AE/path-v01` or current working branch and inspect uploaded artifacts.

5. Medium — Final UI polish & docs (2–4h)

- Why: release-ready demo and user instructions.
- Action: add loading states, clear error toasts, and finalize `docs/` usage examples.

## How I can help next (pick one)

- "Scan and replace pdf-parse" — I will search the repo and create a small PR to remove any remaining `pdf-parse` usage.
- "Add font/DPI checks" — I will implement conservative font/DPI assertions in the server export tests and push a PR.
- "Open PR and run CI" — I will prepare a PR description and (if you authorize) open the PR so CI runs and uploads artifacts.

Completion note: this file now serves as the canonical, short project status for v0.1 work: clear Done/Deferred items and a prioritized next-steps list. Tell me which of the three actions above you want me to start and I will proceed.
```
