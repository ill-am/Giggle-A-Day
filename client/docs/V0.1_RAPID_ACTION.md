# V0.1 RAPID ACTION: UI Responsiveness — Urgent Focus

## Objective

Make the prototype UI feel alive and responsive immediately. Prioritize the smallest set of changes that remove the "dead" feeling from the GUI and provide clear, immediate feedback for every user action. Work in hours, not days.

---

## Top-level decision (scope)

Only changes required to make the GUI responsive for the prototype will be implemented now. Defer deep architectural refactors, extensive instrumentation, and production hardening to follow-up work.

---

## Priority actionables (execute in order)

Immediate (do now — highest impact, low risk)

1. Hide / make dev indicator toggleable

- What: Remove or hide the bottom "DEV UI STATE: idle" for normal users. Make it visible only when a dev flag is enabled (`VITE_DEV_UI=true`) or move it into a collapsible dev overlay.
- Files: footer or layout component where the text is rendered (search for `DEV UI STATE`), add env toggle.
- Acceptance: indicator not shown by default; no layout shift; toggleable in dev.
- Est.: 0.5h

2. Preview: show placeholder immediately, replace or clear on result

- What: Implement a `PreviewSkeleton` (layout skeleton + optional shimmer) and a centered spinner/message. On generate: show skeleton+spinner immediately. On success: crossfade to content. On failure: clear content and show an error panel with a prominent "Try again" button.
- Files: `client/src/components/Preview.svelte` (or equivalent), add `PreviewSkeleton.svelte`, `Spinner.svelte`, update `previewStore` or caller logic to expose `isPreviewing`, `previewError`.
- Acceptance: skeleton displays within 50ms of action; content fades in smoothly (150–250ms); errors replace skeleton and show retry.
- Est.: 2–4h

3. Button states: immediate visual feedback

- What: Show spinner+disabled visual on primary actions (Generate). Ensure visual contrast for disabled state and quick state change (<100ms perceived).
- Files: button component(s) used for generation actions.
- Acceptance: clicking Generate immediately shows spinner and disabled style; prevents duplicate requests.
- Est.: 0.5–1h

4. Race protection: apply update tokens/version ids

- What: Add a lightweight `updateId` (monotonic id or UUID) attached to each generation request. Apply results only if `updateId` matches latest request to avoid stale overwrites.
- Files: `client/src/stores/previewStore.js` (or request caller); `uiStateStore` adjustments as needed.
- Acceptance: rapid repeated generates only show final result; no flicker from older responses.
- Est.: 1–3h

Short-term (same day, moderate effort)

5. Reduce debounce and enforce minimal skeleton time

- What: Set auto-preview debounce to 200ms (configurable). Enforce a minimal skeleton visibility (e.g., 300ms) to avoid perceptual flashing for fast responses.
- Files: `previewStore`, config/constants.
- Acceptance: debounce 200ms default; skeleton visible ≥300ms when shown.
- Est.: 1–2h

6. Error UX: persistent, accessible error state + retry

- What: Ensure error messages persist until user dismisses or retries. Move keyboard focus to the error panel when it appears for accessibility and rapid recovery.
- Files: `Preview.svelte`, `StatusDisplay.svelte` or shared `uiStateStore`.
- Acceptance: errors persist and receive focus; Try Again retriggers flow and re-displays skeleton.
- Est.: 1–2h

Follow-up (optional before handoff)

7. Smooth transitions and accessible live regions

- What: Crossfade skeleton ↔ content (150–250ms) and apply `aria-live` rules: loading polite, errors assertive. Add `role="status"` where appropriate.
- Est.: 1–2h

8. Minimal tests (unit + integration smoke)

- What: Add small Vitest tests to verify preview flows (loading→success, loading→error→retry) and a test for race protection (updateId). Keep tests small and fast.
- Est.: 0.5–1 day

---

## Quick implementation checklist (for PRs)

- [x] Hide/dev-toggle `DEV UI STATE` indicator (dev-only)
- [x] Add `PreviewSkeleton.svelte` and `Spinner.svelte`
- [x] Update `Preview.svelte` to show skeleton/spinner on generate and error panel on failure (implemented in `PreviewWindow.svelte`)
- [x] Update Generate button to show spinner/disabled state immediately
- [x] Add `updateId` protection in preview request flow
- [x] Reduce debounce to 200ms and enforce skeleton min-time (300ms)
- [ ] Add basic accessibility (aria-live, focus on error)
- [ ] Add 2–3 unit/integration tests for the flow

---

## Verification (manual smoke)

1. Start client (dev). Click Generate once — skeleton+spinner appear immediately; content replaces skeleton on success with smooth fade.
2. Click Generate repeatedly — only final content shows after operations complete; no older content overwrites later content.
3. Force a failure (simulate server error) — skeleton/spinner replaced by error panel; focus lands in error panel; Try Again re-attempts and shows skeleton.

---

## Implementation log

Document PRs/changes here as they are merged:

| Date       | Change                                                                                                                                                                                                                                                                                                                                           | PR/Notes                                                                                                                                                          |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2025-09-05 | Implemented rapid UI responsiveness fixes: hid dev indicator behind `VITE_DEV_UI`, added `Spinner.svelte` and `PreviewSkeleton.svelte`, updated `PreviewWindow.svelte` to show skeleton+spinner, added updateId race protection, reduced debounce to 200ms, enforced 300ms minimal skeleton visibility, updated Generate button to show spinner. | Changes in `client/src/components/StatusDisplay.svelte`, `PreviewWindow.svelte`, `PromptInput.svelte`, new components `Spinner.svelte`, `PreviewSkeleton.svelte`. |

Verification notes:

- `DEV UI STATE` hidden: manual verification confirmed by user.
- Component + store changes: unit tests (Vitest) pass; automated headless verification attempted but could not detect the `data-testid` preview element (logs show preview API 200 and preview HTML returned). A DOM attribute marker (`data-preview-updated`) is present indicating preview flow executed; further manual visual verification recommended (open app in browser and load demo). See details in implementation log above.

---

If you want, I can implement the Immediate items now (hide dev indicator, add skeleton/spinner, wire error panel, and add update token protection). Confirm and I will proceed to make the code edits and run tests.
